# Установка и первоначальная настройка Proxmox VE: Пошаговая инструкция

Это руководство поможет пользователю шаг за шагом пройти через весь процесс, включая подготовительные действия и основные настройки для успешного запуска и работы виртуализационной среды Proxmox.

## Оглавление
- [Установка и первоначальная настройка Proxmox VE: Пошаговая инструкция](#установка-и-первоначальная-настройка-proxmox-ve-пошаговая-инструкция)
  - [Оглавление](#оглавление)
  - [Введение](#введение)
  - [Требования к системе](#требования-к-системе)
  - [Загрузка Proxmox VE](#загрузка-proxmox-ve)
  - [Создание загрузочного носителя](#создание-загрузочного-носителя)
    - [1. Выбор программного обеспечения](#1-выбор-программного-обеспечения)
    - [2. Создание загрузочного носителя с помощью Rufus (Windows)](#2-создание-загрузочного-носителя-с-помощью-rufus-windows)
    - [3. Создание загрузочного носителя с помощью Etcher (Windows, macOS, Linux)](#3-создание-загрузочного-носителя-с-помощью-etcher-windows-macos-linux)
    - [4. Создание загрузочного носителя с помощью UNetbootin (Windows, macOS, Linux)](#4-создание-загрузочного-носителя-с-помощью-unetbootin-windows-macos-linux)
  - [Установка Proxmox VE](#установка-proxmox-ve)
    - [Выбор языка установки](#выбор-языка-установки)
    - [Лицензионное соглашение](#лицензионное-соглашение)
    - [Выбор целевого диска](#выбор-целевого-диска)
    - [Настройка региона и часового пояса](#настройка-региона-и-часового-пояса)
    - [Настройка сетевых параметров](#настройка-сетевых-параметров)
    - [Подтверждение установки](#подтверждение-установки)
  - [Первоначальная настройка Proxmox VE](#первоначальная-настройка-proxmox-ve)
    - [Настройка сети WiFi (можно пропустить, если подключены к ethernet)](#настройка-сети-wifi-можно-пропустить-если-подключены-к-ethernet)
    - [Настройка NTP-сервера (Google) для кореектного отображения времени](#настройка-ntp-сервера-google-для-кореектного-отображения-времени)
    - [Добавление репозиториев](#добавление-репозиториев)
    - [Обновление системы](#обновление-системы)
    - [Доступ к веб-интерфейсу](#доступ-к-веб-интерфейсу)
    - [Настройка сети](#настройка-сети)
  - [Заключение](#заключение)

## Введение

Proxmox Virtual Environment (Proxmox VE) — это мощная платформа для управления виртуализацией, объединяющая возможности KVM (виртуальные машины) и LXC (контейнеры). В этой инструкции мы рассмотрим процесс установки Proxmox VE, а также первоначальную настройку системы для оптимальной работы.

## Требования к системе

Перед началом установки убедитесь, что ваш ПК соответствует минимальным системным требованиям:

- **Процессор:** 64-битный процессор с поддержкой виртуализации (Intel VT-x или AMD-V).
- **Оперативная память:** минимум 2 ГБ ОЗУ (рекомендуется 4 ГБ и больше).
- **Место на диске:** минимум 32 ГБ на системный диск (рекомендуется SSD).
- **Сетевой интерфейс:** минимум 1 гигабитный интерфейс.

## Загрузка Proxmox VE

1. Перейдите на [официальный сайт Proxmox](https://www.proxmox.com/en/downloads) и скачайте последнюю версию Proxmox VE.
2. Выберите ISO-образ и загрузите его на локальный компьютер.

## Создание загрузочного носителя

Для установки Proxmox VE необходимо создать загрузочный USB-носитель, который позволит вам загрузить ПК и начать установку системы. В этом разделе подробно описан процесс подготовки такого носителя.

### 1. Выбор программного обеспечения

Для создания загрузочного USB-носителя можно использовать различные инструменты. Ниже перечислены наиболее популярные и удобные:

- **Rufus** (Windows): бесплатная и простая в использовании программа для создания загрузочных USB-накопителей.
- **Etcher** (Windows, macOS, Linux): кроссплатформенное приложение с простым интерфейсом.
- **UNetbootin** (Windows, macOS, Linux): ещё одно кроссплатформенное приложение, поддерживающее множество дистрибутивов.

### 2. Создание загрузочного носителя с помощью Rufus (Windows)

Если вы используете Windows, Rufus — это удобный инструмент для создания загрузочного USB-накопителя:

1. **Загрузка и установка Rufus:**
   - Скачайте последнюю версию Rufus с [официального сайта](https://rufus.ie/).
   - Запустите программу (установка не требуется).

2. **Подключение USB-накопителя:**
   - Вставьте USB-накопитель в компьютер. Обратите внимание, что все данные на носителе будут удалены.

3. **Настройка Rufus:**
   - В разделе **Device** выберите ваш USB-накопитель.
   - В разделе **Boot selection** нажмите на кнопку "SELECT" и выберите ранее скачанный ISO-образ Proxmox VE.

4. **Запись образа:**
   - Нажмите кнопку "START" для начала записи.
   - Rufus может попросить разрешение скачать дополнительные файлы. Согласитесь, если появится запрос.
   - Подтвердите форматирование USB-накопителя и дождитесь завершения процесса.

### 3. Создание загрузочного носителя с помощью Etcher (Windows, macOS, Linux)

Etcher — кроссплатформенное приложение с интуитивно понятным интерфейсом:

1. **Загрузка и установка Etcher:**
   - Скачайте последнюю версию Etcher с [официального сайта](https://www.balena.io/etcher/).
   - Установите и запустите программу.

2. **Подключение USB-накопителя:**
   - Вставьте USB-накопитель в компьютер. Обратите внимание, что все данные на носителе будут удалены.

3. **Настройка Etcher:**
   - Нажмите на кнопку "Flash from file" и выберите ISO-образ Proxmox VE.
   - Нажмите на кнопку "Select target" и выберите ваш USB-накопитель.

4. **Запись образа:**
   - Нажмите кнопку "Flash!" для начала процесса записи.
   - Дождитесь завершения записи и проверки данных.

### 4. Создание загрузочного носителя с помощью UNetbootin (Windows, macOS, Linux)

UNetbootin — ещё один популярный инструмент для создания загрузочных USB-накопителей:

1. **Загрузка и установка UNetbootin:**
   - Скачайте последнюю версию UNetbootin с [официального сайта](https://unetbootin.github.io/).
   - Установите и запустите программу.

2. **Подключение USB-накопителя:**
   - Вставьте USB-накопитель в компьютер.

3. **Настройка UNetbootin:**
   - В разделе "Diskimage" выберите "ISO".
   - Нажмите на кнопку "..." и выберите скачанный ISO-образ Proxmox VE.
   - Убедитесь, что выбран ваш USB-накопитель в разделе "Drive".

4. **Запись образа:**
   - Нажмите "OK" для начала процесса записи.
   - Дождитесь завершения записи и извлеките USB-накопитель.

## Установка Proxmox VE

### Выбор языка установки

1. Загрузите ПК с подготовленного USB-накопителя.
2. В меню загрузки выберите "Install Proxmox VE" и нажмите `Enter`.
3. В появившемся меню выберите предпочтительный язык установки и нажмите `Next`.

### Лицензионное соглашение

1. Примите лицензионное соглашение, выбрав "I agree" и нажмите `Next`.

### Выбор целевого диска

1. На экране выбора диска выберите целевой диск для установки Proxmox VE.
2. Нажмите `Next`, чтобы продолжить.

### Настройка региона и часового пояса

1. Выберите ваш регион и часовой пояс.
2. Настройте раскладку клавиатуры, если это необходимо.
3. Нажмите `Next`.

### Настройка сетевых параметров

1. Укажите hostname (имя сервера) и домен (например, `proxmox.local`).
2. Настройте IP-адрес, маску сети, шлюз и DNS-серверы.
3. Нажмите `Next`.

### Подтверждение установки

1. Проверьте все настройки. Если всё верно, нажмите `Install`, чтобы начать процесс установки.
2. После завершения установки извлеките USB-накопитель и перезагрузите ПК.

## Первоначальная настройка Proxmox VE

### Настройка сети WiFi (можно пропустить, если подключены к ethernet)
Данный пункт описывает первоначальную настройку сети Proxmox из консоли для подключения ПК к интернету через вайфай.
Инструкция находится по [данной ссылке](https://github.com/ProxVirtualZone/ProxVirtualZone/blob/master/1.%20%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0%20%D0%B8%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0%20Proxmox%20VE/1.1%20%D0%9D%D1%8E%D0%B0%D0%BD%D1%81%20%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8%20Proxmox%20%D0%BF%D1%80%D0%B8%20%D0%BE%D1%82%D1%81%D1%83%D1%82%D1%81%D0%B2%D0%B8%D0%B8%20%D1%84%D0%B8%D0%B7%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B3%D0%BE%20Ethernet%20%D0%B8%20%D0%BD%D0%B0%D0%BB%D0%B8%D1%87%D0%B8%D0%B8%20WiFi.md).

### Настройка NTP-сервера (Google) для кореектного отображения времени

1. После перезагрузки ПК у вас появиться доступ к Proxmox через командную строку.
2. Необходимо войти в свой аккаунт: 
   логин: root
   пароль: ваш_пароль, который указывали при установке.
3. Настройте Chrony для использования NTP сервера Google:

    Откройте файл конфигурации `chrony`:
    ```bash
    nano /etc/chrony/chrony.conf
    ```

    Найдите и закомменитруйте строки, начинающиеся с `pool` или `server`.
    Добавьте следующие строки:
    ```plaintext
    server time1.google.com iburst
    server time2.google.com iburst
    server time3.google.com iburst
    server time4.google.com iburst
    ```
4. Перезапустите службу Chrony для применения изменений:
    ```bash
    systemctl restart chrony
    ```
5. Проверьте статус синхронизации времени:
    ```bash
    journalctl --since -1h -u chrony
    ```
    Должно выдать примерно следующее:
    ```plaintext
    ...
      Aug 26 13:00:09 node1 systemd[1]: Started chrony, an NTP client/server.
      Aug 26 13:00:15 node1 chronyd[4873]: Selected source 10.0.0.1 (ntp1.example.com)
      Aug 26 13:00:15 node1 chronyd[4873]: System clock TAI offset set to 37 seconds
    ...
    ```

### Добавление репозиториев

1. По умолчанию Proxmox VE настроен на использование корпоративного репозитория. Если у вас нет подписки, рекомендуется добавить бесплатный репозиторий.
2. Откройте файл `/etc/apt/sources.list.d/pve-enterprise.list` и закомментируйте строку с корпоративным репозиторием.
3. Добавьте следующую строку в `/etc/apt/sources.list`:
   ```
   deb http://download.proxmox.com/debian/pve bookworm pve-no-subscription
   ```

### Обновление системы

1. Обновите систему с помощью следующих команд:
   ```bash
   apt update
   apt dist-upgrade
   ```
2. Перезагрузите сервер после обновления.

### Доступ к веб-интерфейсу

1. После перезагрузки откройте веб-браузер и введите IP-адрес вашего ПК с указанием порта 8006 (например, `https://192.168.1.100:8006`).
2. Введите логин и пароль администратора (root) для доступа к веб-интерфейсу.

### Настройка сети

1. В веб-интерфейсе перейдите в раздел `Datacenter -> Node -> Network`.
2. Настройте мостовые интерфейсы (bridge) для создания виртуальных сетей.
3. Добавьте дополнительные IP-адреса или VLAN, если необходимо.

## Заключение

Поздравляем! Вы успешно установили и настроили Proxmox VE. Теперь ваш ПК готов к управлению виртуальными машинами и контейнерами.